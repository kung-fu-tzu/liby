<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" id="event-page" class="loading finans-bank-forum-2 status-archive">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<link rel="stylesheet" href="tests.css" type="text/css"/>
	<title>Event classes tests</title>
</head>
<body>

<!--[if lte IE 7]><script type="text/javascript" src="../programica/fixes/trident3.js"></script><![endif]-->
<!--[if IE 8]><script type="text/javascript" src="../programica/trident4.js"></script><![endif]-->
<script type="text/javascript" src="../programica/fixes/log.js"></script>
<script type="text/javascript" src="../programica/init.js"></script>

<script type="text/javascript" src="tests.js"></script>
<script type="text/javascript">
	window.addEventListener('load', function () {
	tests.plan(11)
	
	var messed =
	[
		{x: 2, y: 0, z: 0},
		{x: 2, y: 0, z: 1},
		{x: 2, y: 0, z: 2},
		{x: 2, y: 1, z: 0},
		{x: 2, y: 1, z: 1},
		{x: 2, y: 1, z: 2},
		{x: 2, y: 2, z: 0},
		{x: 2, y: 2, z: 1},
		{x: 2, y: 2, z: 2},
		
		{x: 0, y: 0, z: 0},
		{x: 0, y: 0, z: 1},
		{x: 0, y: 0, z: 2},
		{x: 0, y: 1, z: 0},
		{x: 0, y: 1, z: 1},
		{x: 0, y: 1, z: 2},
		{x: 0, y: 2, z: 0},
		{x: 0, y: 2, z: 1},
		{x: 0, y: 2, z: 2},
		
		{x: 1, y: 0, z: 0},
		{x: 1, y: 0, z: 1},
		{x: 1, y: 0, z: 2},
		{x: 1, y: 1, z: 0},
		{x: 1, y: 1, z: 1},
		{x: 1, y: 1, z: 2},
		{x: 1, y: 2, z: 0},
		{x: 1, y: 2, z: 1},
		{x: 1, y: 2, z: 2}
	]
	
	var sorted =
	[
		{x: 0, y: 0, z: 0},
		{x: 0, y: 0, z: 1},
		{x: 0, y: 0, z: 2},
		{x: 0, y: 1, z: 0},
		{x: 0, y: 1, z: 1},
		{x: 0, y: 1, z: 2},
		{x: 0, y: 2, z: 0},
		{x: 0, y: 2, z: 1},
		{x: 0, y: 2, z: 2},
		
		{x: 1, y: 0, z: 0},
		{x: 1, y: 0, z: 1},
		{x: 1, y: 0, z: 2},
		{x: 1, y: 1, z: 0},
		{x: 1, y: 1, z: 1},
		{x: 1, y: 1, z: 2},
		{x: 1, y: 2, z: 0},
		{x: 1, y: 2, z: 1},
		{x: 1, y: 2, z: 2},
		
		{x: 2, y: 0, z: 0},
		{x: 2, y: 0, z: 1},
		{x: 2, y: 0, z: 2},
		{x: 2, y: 1, z: 0},
		{x: 2, y: 1, z: 1},
		{x: 2, y: 1, z: 2},
		{x: 2, y: 2, z: 0},
		{x: 2, y: 2, z: 1},
		{x: 2, y: 2, z: 2}
	]
	
	var backup = messed.slice()
	
	function x (a, b) { return a.x - b.x }
	function y (a, b) { return a.y - b.y }
	function z (a, b) { return a.z - b.z }
	function single (a, b) { return x(a, b) || y(a, b) || z(a, b) }
	function combined (a, b) { return a.x - b.x || a.y - b.y || a.z - b.z }
	
	var temp = messed.slice(),
		speed = tests.speed(function () { temp.sort(single) }),
		count = Math.round(speed / 5)
	
	tests.log('runs ' + count + ' times')
	
	var m = messed.slice()
	tests.time('multiple')
	for (var i = 0; i < count; i++)
	{
		m.sort(z),
		m.sort(y),
		m.sort(x)
	}
	var mtime = tests.timeEnd('multiple')
	tests.eqo(m, sorted, 'multiple sorts as expected')
	
	
	
	var s = messed.slice()
	tests.time('single')
	for (var i = 0; i < count; i++)
	{
		s.sort(single)
	}
	var stime = tests.timeEnd('single')
	tests.eqo(s, sorted, 'single sorts as expected')
	
	
	
	var c = messed.slice()
	tests.time('combined')
	for (var i = 0; i < count; i++)
	{
		c.sort(combined)
	}
	var ctime = tests.timeEnd('combined')
	tests.eqo(c, sorted, 'combined sorts as expected')
	
	
	tests.eqo(s, m, 'single and multiple sorts acts the same')
	tests.eqo(s, c, 'single and combined sorts acts the same')
	tests.neo(m, messed, 'doublecheck: multiple is not messed')
	tests.neo(s, messed, 'doublecheck: single is not messed')
	tests.gt(mtime, stime, 'multiple takes more time then single')
	tests.gt(mtime, stime, 'single takes more time then combined')
	
	tests.eqo(messed, backup, 'messed left untouched')
	tests.eqo(messed, backup, 'messed not equals to sorted')
	
	log(messed[0])
	
	tests.done()
	}, false)
</script>
</body>
</html>
