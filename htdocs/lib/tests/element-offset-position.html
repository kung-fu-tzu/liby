<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=320"/>
	<title>Element#offsetPosition() tests</title>
	
	<script src="tests.common.js" type="text/javascript"></script>
	
	<!--[if lte IE 7]><script type="text/javascript" src="../core/fixes/trident3.js"></script><![endif]-->
	<!--[if gte IE 8]><script type="text/javascript" src="../core/fixes/trident4.js"></script><![endif]-->
	<script type="text/javascript" src="../core/prototype.js"></script>
	<script type="text/javascript" src="../modules/element.js"></script>
	
	<style type="text/css">
	/* needed for overflow */
	.spacer { position: absolute; left: 0px; top: 0px; width: 5000px; height: 10000px; }
	/* needed for nesting */
	.box { position: absolute; left: 10px; top: 10px; width: 10px; height: 10px; overflow: hidden; }
	
	#in-body { position: absolute; left: 10px; top: 20px; }
	#in-document-element { position: absolute; left: 30px; top: 40px; }
	#in-scrolled-box { position: absolute; left: 50px; top: 60px; }
	#self-scrolled { position: absolute; left: 70px; top: 80px; width: 10px; height: 20px; overflow: hidden; }
	</style>
</head>
<body>
<div class="spacer"></div>

<div id="in-body"></div>

<!-- will be appended to the documentElement -->
<div id="in-document-element"></div>

<!-- box will be scrolled left and top -->
<div class="box"><div id="in-scrolled-box"></div><div class="spacer"></div></div>

<!-- will be scrolled left and top -->
<div class="box"><div id="self-scrolled"><div class="spacer"></div></div></div>

<script type="text/javascript">
Tests.test(function (t)
{
	function $ (id) { return document.getElementById(id) }
	
	t.test('in body', function (t)
	{
		var node = $('in-body')
		var pos = node.offsetPosition()
		
		t.eq(pos.left, 10, 'left')
		t.eq(pos.top, 20, 'top')
	})
	
	t.test('in documentElement', function (t)
	{
		var node = $('in-document-element')
		document.documentElement.appendChild(node)
		var pos = node.offsetPosition()
		
		t.eq(pos.left, 30, 'left')
		t.eq(pos.top, 40, 'top')
	})
	
	t.test('in documentElement scrolled', function (t)
	{
		var node = $('in-document-element')
		document.documentElement.appendChild(node)
		document.documentElement.scrollLeft = 15
		document.documentElement.scrollTop = 25
		var pos = node.offsetPosition()
		
		t.eq(pos.left, 30 - 15, 'left')
		t.eq(pos.top, 40 - 25, 'top')
	})
	
	t.test('in scrolled box', function (t)
	{
		var node = $('in-scrolled-box')
		node.parentNode.scrollLeft = 15
		node.parentNode.scrollTop = 25
		var pos = node.offsetPosition()
		
		t.eq(pos.left, 50 - 15 + 10, 'left')
		t.eq(pos.top, 60 - 25 + 10, 'top')
	})
	
	t.test('self scrolled', function (t)
	{
		var node = $('self-scrolled')
		node.scrollLeft = 1000
		node.scrollTop = 2000
		var pos = node.offsetPosition()
		
		t.eq(pos.left, 70 + 10, 'left')
		t.eq(pos.top, 80 + 10, 'top')
	})
})
</script>
</body>
</html>