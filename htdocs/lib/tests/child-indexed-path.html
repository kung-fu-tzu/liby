<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=320"/>
	<link rel="stylesheet" href="tests.css" type="text/css"/>
	<title>Element#childIndexedPath() and Element#childByIndexedPath() tests</title>
</head>
<body>

<div id="node-0"></div>
<div id="node-1"><div id="node-1-0"><div id="node-1-0-0"></div></div></div>
<div id="node-2">text <b id="bold">bold <i id="italic">bold italic</i> <img id="img"/> bold</b> text</div>

<div id="messy-node">
	<script type="text/javascript" id="messy-node-0">document.write('<p id="messy-node-1"></p>')</script>
	text &amp; text
	<!-- comment -->
	<div id="messy-node-2"></div>
	text &gt; text
	<!-- comment 2 -->
	<div id="messy-node-3"></div>
</div>

<!--[if lte IE 7]><script type="text/javascript" src="../programica/fixes/trident3.js"></script><![endif]-->
<!--[if gte IE 8]><script type="text/javascript" src="../programica/fixes/trident4.js"></script><![endif]-->
<script type="text/javascript" src="../programica/prototype.js"></script>
<script type="text/javascript" src="../modules/cosy.js"></script>
<script type="text/javascript" src="../modules/child-indexed-path.js"></script>

<!--# include virtual="tests.includes.html" -->
<script type="text/javascript">
Tests.test(function (t)
{
	t.test('childIndexedPath()', function (t)
	{
		t.test('prerequisites', function (t)
		{
			t.no(document.parentNode, '!document.parentNode')
		})
		
		t.test('document', function (t)
		{
			t.eqo(document.childIndexedPath(document.body), [0, 1], 'body in document')
			t.eqo(document.childIndexedPath(document.getElementsByTagName('head')[0]), [0, 0], 'head in document')
			t.eqo(document.childIndexedPath(document), [], 'document in document')
			t.eqo(document.childIndexedPath(document.documentElement), [0], 'documentElement in document')
		})
		
		t.test('empty paths', function (t)
		{
			t.eqo(document.body.childIndexedPath(document), null, 'document in body')
			t.eqo(document.body.childIndexedPath(document.body), [], 'body in body')
		})
		
		t.test('nested nodes', function (t)
		{
			t.eqo(document.body.childIndexedPath($('node-0')), [0], 'node-0 in body')
			t.eqo(document.body.childIndexedPath($('node-1')), [1], 'node-1 in body')
			t.eqo(document.body.childIndexedPath($('node-1-0')), [1, 0], 'node-1-0 in body')
			t.eqo(document.body.childIndexedPath($('node-1-0-0')), [1, 0, 0], 'node-1-0-0 in body')
			t.eqo(document.body.childIndexedPath($('italic')), [2, 0, 0], 'italic in body')
			t.eqo(document.body.childIndexedPath($('img')), [2, 0, 1], 'img in body')
		})
		
		t.test('messy nodes', function (t)
		{
			var messy = $('messy-node')
			t.eqo(messy.childIndexedPath(document.body), null, 'body in messy')
			t.eqo(messy.childIndexedPath($('messy-node-0')), [0], 'script in messy')
			t.eqo(messy.childIndexedPath($('messy-node-1')), [1], 'p in messy')
			t.eqo(messy.childIndexedPath($('messy-node-2')), [2], 'node-2 in messy (after text and a comment)')
			t.eqo(messy.childIndexedPath($('messy-node-3')), [3], 'node-3 in messy (after even more text and a comments)')
		})
	})
	
	// nice copy-pase example ;)
	t.test('childByIndexedPath()', function (t)
	{
		t.test('document', function (t)
		{
			t.eq(document.childByIndexedPath([0, 1]), document.body, 'body in document')
			t.eq(document.childByIndexedPath([0, 0]), document.getElementsByTagName('head')[0], 'head in document')
			t.eq(document.childByIndexedPath([]), document, 'document in document')
			t.eq(document.childByIndexedPath([0]), document.documentElement, 'documentElement in document')
		})
		
		t.test('tricky paths', function (t)
		{
			t.eq(document.body.childByIndexedPath([]), document.body, 'empty path in body')
			t.eq(document.body.childByIndexedPath([0,0,0,0,0,0]), null, 'too deep in body')
			t.eq(document.body.childByIndexedPath([100]), null, 'too far in body')
			t.eq(document.body.childByIndexedPath([-1]), null, 'negative chils num in body')
		})
		
		t.test('nested nodes', function (t)
		{
			t.eq(document.body.childByIndexedPath([0]), $('node-0'), 'node-0 in body')
			t.eq(document.body.childByIndexedPath([1]), $('node-1'), 'node-1 in body')
			t.eq(document.body.childByIndexedPath([1, 0]), $('node-1-0'), 'node-1-0 in body')
			t.eq(document.body.childByIndexedPath([1, 0, 0]), $('node-1-0-0'), 'node-1-0-0 in body')
			t.eq(document.body.childByIndexedPath([2, 0, 0]), $('italic'), 'italic in body')
			t.eq(document.body.childByIndexedPath([2, 0, 1]), $('img'), 'img in body')
		})
		
		t.test('messy nodes', function (t)
		{
			var messy = $('messy-node')
			t.eq(messy.childByIndexedPath([0]), $('messy-node-0'), 'script in messy')
			t.eq(messy.childByIndexedPath([1]), $('messy-node-1'), 'p in messy')
			t.eq(messy.childByIndexedPath([2]), $('messy-node-2'), 'node-2 in messy (after text and a comment)')
			t.eq(messy.childByIndexedPath([3]), $('messy-node-3'), 'node-3 in messy (after even more text and a comments)')
		})
	})
})
</script>
</body>
</html>
