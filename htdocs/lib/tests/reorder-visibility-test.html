<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=320"/>
	<link rel="stylesheet" href="tests.css" type="text/css"/>
	<title>Reorder visibility tests</title>
</head>
<body>

<ul id="test-1-0"></ul>
<ul id="test-1-1"></ul>
<ul id="test-1-2"></ul>
<ul id="test-2" style="visibility: hidden"></ul>
<ul id="test-3" style="display: none"></ul>
<ul id="test-4" style="width: 100px; height: 100px; overflow: hidden"></ul>
<ul id="test-5" style="position: absolute"></ul>
<ul id="test-6"></ul>


<script type="text/javascript" src="../modules/cascade.js"></script>
<script type="text/javascript" src="../tests.js"></script>
<script type="text/javascript">
Tests.test(function (t)
{
	var globalTime = new Date()
	
	function fill (root)
	{
		var nodes = []
		// t.time('fill')
		for (var i = 0; i < 3000; i++)
			root.appendChild(nodes[i] = document.createElement('li')).appendChild(document.createTextNode(i))
		// t.timeEnd('fill')
		return nodes
	}
	
	function job (root, nodes)
	{
		for (var i = 0, il = nodes.length; i < il; i++)
			root.appendChild(nodes[i])
	}
	
	
	
	t.test(function ()
	{
		var root = document.getElementById('test-1-0'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		t.time('normal')
		job(root, nodes)
		t.async(function () { t.timeEnd('normal') })
	})
	
	t.test(function ()
	{
		var root = document.getElementById('test-1-1'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		
		t.time('style.visibility = hidden')
		root.style.visibility = 'hidden'
		job(root, nodes)
		root.style.visibility = 'visible'
		t.async(function () { t.timeEnd('style.visibility = hidden') })
	})
	
	t.test(function ()
	{
		var root = document.getElementById('test-1-2'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		t.time('style.display = none')
		root.style.display = 'none'
		job(root, nodes)
		root.style.display = 'block'
		t.async(function () { t.timeEnd('style.display = none') })
	})
	
	
	t.test(function ()
	{
		var root = document.getElementById('test-2'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		t.time('visibility: hidden')
		job(root, nodes)
		t.async(function () { t.timeEnd('visibility: hidden') })
	})
	
	
	t.test(function ()
	{
		var root = document.getElementById('test-3'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		t.time('display: none')
		job(root, nodes)
		t.async(function () { t.timeEnd('display: none') })
	})
	
	
	t.test(function ()
	{
		var root = document.getElementById('test-4'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		t.time('overflow: hidden')
		job(root, nodes)
		t.async(function () { t.timeEnd('overflow: hidden') })
	})
	
	
	t.test(function ()
	{
		var root = document.getElementById('test-5'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		t.time('position: absolute')
		job(root, nodes)
		t.async(function () { t.timeEnd('position: absolute') })
	})
	
	
	t.test(function ()
	{
		var root = document.getElementById('test-5'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		var parent = root.parentNode
		t.time('removed-n-appended')
		parent.removeChild(root)
		job(root, nodes)
		parent.appendChild(root)
		t.async(function () { t.timeEnd('removed-n-appended') })
	})
	
	
	t.test(function ()
	{
		var root = document.createElement('ul'),
			nodes = fill(root)
		
		// warming
		job(root, nodes)
		
		t.time('not appended')
		job(root, nodes)
		t.async(function () { t.timeEnd('not appended') })
	})
})
</script>
</body>
</html>
